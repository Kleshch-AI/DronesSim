# DronesSim
A simulation where drones from two factions collect randomly spawned resources and carry them to their respective bases. Configured through UI.

## Что реализовано:
### Сцена, в которой содержатся:
- Две базы дронов, на каждой висит DronesSpawner, которому можно задать тип дрона (там же назначаем префаб дрона, но это надо исправить).
- ResourceSpawner, к которому приделан BoxCollider2D, внутри которого спавнятся ресурсы (та же фигня с префабом, что и у спавнеров дронов (см. выше)).
- Canvas, на нём UIManager, у которого есть кнопка включения/выключения настроек, и сами настройки (SettingsUI).
- Объект [STARTUP] – единая точка входа, собирает все необходимые MonoBehaviour зависимости из сцены, заводит GameManager.

### Логика
- Спавн ресурсов через определённый интервал в определённой области, ограниченной коллайдером. Pooling всех ресурсов.
- Спавн определённого количества дронов. Количество можно настраивать через окно настроек. Pooling дронов.
- Поиск, сбор ресурсов, возвращение на базу, избежание столкновений. Используемый подход – Steering Behaviours.
- Конфиги в папке Configs. Значения Movement Settings и Steering Behaviour Settings можно изменять в runtime для точной настройки движения дронов на лету.

## Технологии и подходы
- UniRx для связи модели и UI, в будущем при необходимости модели и контроллеров/view.
- Addressables для загрузки конфигурации.
- Steering Behaviours для движения дронов (поведение Seek и Evade). Возможность включать и выключать поведения в runtime.
- Простая state machine для состояние дрона. 

## Known bugs
- Первые пару секунд игры дроны не сталкиваются.

## TODO
### Архитектура и производительность
- [x] Зарефакторить модель-конфиг: модель не должна быть посредником для передачи настроек из конфига. Не стоит бояться зависимости от конфига в контроллерах. Убрать лишние поля из моделей, которые только ссылаются на соотвествующие поля в конфигах.
- [ ] Кешировать найденные препятствия в SteeringBehaviourController.GetSeparationForce(), обновлять по подписке на событие о спавне/удалении дронов.
- [ ] Не прокидывать зависимость от модели в UI.
- [ ] Перенести настройки префабов дронов в конфиг.
- [ ] Зарефакторить Update в DroneController – плохая читаемость. Возможно, перенести эту логику в модель (см. ниже).
- [ ] ??? Перенести логику движения поиска ресурса и движения в модель, DroneController будет только отображать (возможно, он даже превратится в полностью пассивный DroneView). Таким образом, меньше зависимости от Unity, тупой View – легче тестировать, менять отображение. А ещё можно будет сохранять позицию всего.
- [ ] ??? Изменить логику спавна ресурсов – вместо Observable.Interval перенести всё в Update, тогда можно будет менять интервал и количество на лету.

### Фичи
- [ ] Добавить динамическую настройку скорости дронов через UI.
- [ ] Добавить эффект выгрузки ресурса.
- [ ] Добавить визуальное отображение статуса дрона (в поиске, с ресурсом и т.д.)
